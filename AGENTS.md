# Repository Guidelines

## Project Structure & Module Organization
- `src/` holds the TypeScript source. Entry points live in `src/index.ts` and `src/client.ts`; shared helpers sit under `src/utils/` and `src/types/`.
- `dist/` is generated by `tsup` and is the only code shipped to npm. Do not edit files there; regenerate via the build commands below.
- `test/` contains Vitest suites (`*.test.ts`). Keep fixtures alongside the specs to emphasize behavior over implementation.

## Build, Test, and Development Commands
- `pnpm install` installs dependencies; use pnpm to keep the lockfile (`pnpm-lock.yaml`) accurate.
- `pnpm run build` bundles `src/index.ts` to both CJS and ESM outputs and refreshes declaration files via `tsup`.
- `pnpm run build-fast` skips the DTS pass for quicker local feedback.
- `pnpm test` runs the Vitest suite in run mode; add `--watch` when iterating (`pnpm test -- --watch`).

## Coding Style & Naming Conventions
- TypeScript is the canonical source. Prefer explicit return types on exported functions and keep shared types in `src/types/`.
- Formatting is managed by Prettier through `@egoist/prettier-config`; run `pnpm exec prettier --check "src/**/*.ts" "test/**/*.ts"` before committing if unsure.
- Follow camelCase for functions, PascalCase for classes/types, and use `kebab-case` for file names unless already established (e.g., `fetch-result-please.ts`).

## Testing Guidelines
- Vitest powers unit tests; colocate new specs in `test/` as `*.test.ts` files that mirror the module name (`client.test.ts`).
- Aim to cover the request lifecycle: outbound options, Mini Program fetch shims, and error handling. Use mocks for `wx.request` interactions.
- Always run `pnpm test` before pushing; include coverage notes or gaps in the PR description when applicable.

## Commit & Pull Request Guidelines
- Follow Conventional Commits (`feat:`, `fix:`, `chore:`) as seen in recent history (e.g., `feat: add d.ts`). Keep subjects in the imperative and under ~72 characters.
- Each PR should link related issues, summarize behavioral changes, and note build/test results. Include screenshots or logs only when they clarify a runtime change.
- Avoid bundling unrelated fixes; small, focused PRs make review and releases smoother.
